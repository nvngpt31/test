#!/bin/bash

  while (( "$#" ))
  do case $1 in
       -f|--file) shift && file="$1"  ;;
     esac
     shift
  done

  rm -f $file
  rm -f /etc/sysctl.hold

  if [[ ! -d /etc/sysctl.d ]]
  then mkdir /etc/sysctl.d
  fi

  if [[ -L /etc/sysctl.d/99-sysctl.conf ]]
  then cat /etc/sysctl.d/* | egrep -v '#' | sed '/^\s*$/d' > /etc/sysctl.hold
  else egrep -v '#' /etc/sysctl.conf | sed '/^\s*$/d' > /etc/sysctl.hold
       cat /etc/sysctl.d/* | egrep -v '#' | sed '/^\s*$/d' >> /etc/sysctl.hold
  fi

  sort /etc/sysctl.hold > $file

