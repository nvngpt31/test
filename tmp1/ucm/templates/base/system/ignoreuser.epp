#####################################################################################
# Contents of this file are managed by UCM/Puppet, you should not edit it manually  #
#####################################################################################
#!/bin/bash

  while (( "$#" )); do
    case $1 in
      -u|--user) shift && user="$1" ;;
    esac
    shift
  done

  if grep -q '7' /etc/redhat-release
  then el='7'
  else el='6'
  fi

  if [[ -z $user ]]
  then echo "please provide user name with -u or --user"
       exit 1
  fi

  file_ignore='/etc/centrifydc/user.ignore'

  adquery user $user >/dev/null 2>&1

  if [[ $? = '0' ]]
  then userinad='true'
  else userinad='false'
  fi

  if [[ $userinad = 'false' ]]
  then exit 0
  fi

  if [[ $userinad = 'true' ]]
  then if ! grep -q $user $file_ignore
       then echo $user >> $file_ignore
       fi

       if [[ $el = '7' ]]
       then systemctl restart centrifydc
       else service centrifydc restart
       fi

       exit 0
  fi

