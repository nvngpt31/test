#!/bin/bash 

  while (( "$#" ))
  do case $1 in
       -f|--file) shift && file="$1" ;;
     esac
     shift
  done

  if [[ -z $file ]] 
  then echo "... Please provide file to YAML file with -f."
       exit 1
  fi 

  if [[ ! -f $file ]] 
  then echo "... Did not find file $file "
       exit 1
  fi 

  # chop of file at end of file and use as dir
  # cd to dir 
  # check if clean
  # grep app lines with files 
  # filter through exclude lists 

  dir="`echo $file | awk 'BEGIN{FS=OFS="/"}{NF--; print}'`"

  cd $dir
  tgit -c 
  if [[ $? != '0' ]] 
  then echo "... Git repo at dir \"$dir\" does not appear to be clean"
       exit 1
  fi 

  definedbranch='release'
  currentbranch="`cd $dir ; tgit -b`"

  if [[ $currentbranch != $definedbranch ]] 
  then echo "... Branch is not set to \"$definedbranch\" for \"$dir\" "
       exit 1
  fi 

  grep '/' $file 
