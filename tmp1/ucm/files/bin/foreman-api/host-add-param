#!/bin/bash

  # this script creates a single name/value "parameter" for an individual host in foreman. 

  while (( "$#" )); do
    case $1 in
      -s|--server)  shift && name="$1"     ;;
      -p|--param) shift && param="$1"  ;;
      -v|--value) shift && value="$1"  ;;
    esac
    shift
  done

  if [[ -z $name || -z $param || -z $value ]] ; then 
    echo ""
    echo "Please run this script with the following args: ./host-add-param -s FQDN -p PARAMNAME -v PARAMVALUE" 
    echo ""
    exit 1
  fi 

  server=$name opts='-s -k' host="ucmnui.associatesys.local" url="https://${host}/api/v2" url_h="${url}/hosts"
  url_h_name="${url}/hosts/${name}/parameters" user='ucmadmin'
  pw='unity2018'
  h_type='Content-Type:application/json'
  h_accept='Accept:application/json'

  curl -kSs -H "Content-type:application/json" -u ${user}:${pw} -X POST $url_h_name -d '{"parameter": {"name":"'"${param}"'","value":"'"${value}"'"}}' | python -m json.tool
