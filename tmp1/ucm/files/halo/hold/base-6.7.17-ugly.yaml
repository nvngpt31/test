---
base::packages:
  'splunkforwarder':
    state: 'latest'
  'tda-splunkUF-client_conucm.1.2.i686':
    state: 'latest'
#
# Place holders
# 'bpa':
#   state: 'latest'
# 'tivoli':
#   state: 'installed'
# 'bigfix': ?
#   state: 'installed'

base::directories:
  '/etc/dconf':
    ensure: 'directory' 
  '/etc/dconf/db':
    ensure: 'directory' 
  '/etc/dconf/db/local.d':
    ensure: 'directory' 
  '/opt/splunkforwarder':
    ensure: 'directory'
    owner: 'splunk' 
    group: 'splunk' 

base::groups:
  'users':
    gid: 103
  'splunk':
    gid: 73023

base::users:
  'splunk':
    gid: 73023

base::links:
  '/etc/systemd/system/ctrl-alt-del.target':
    target: '/dev/null'

base::oneliners:
  'rootpam':
    path: '/etc/security/access.conf'
    line: '-:ALL EXCEPT root (ulse):LOCAL'

base::files:
  '/etc/sudoers.d/taddm':
    template: 'ucm/base/sudo/taddm.erb'
  '/etc/sudoers.d/base':
    template: 'ucm/base/sudo/base.erb'
  '/etc/default/useradd':
    template: 'ucm/base/system/useradd.erb'
  '/etc/profile.d/custom.sh':
    template: 'ucm/base/system/custom.sh.erb'
  '/etc/issue':
    template: 'ucm/base/system/issue.erb'
  '/etc/issue.net':
    template: 'ucm/base/system/issue.net.erb'
  '/etc/dconf/db/local.d/00-disable-CAD':
    template: 'ucm/base/system/00-disable-CAD.erb'
  '/etc/ntp.conf':
    template: 'ucm/base/system/ntp.conf.erb'
  '/etc/sysconucm/ntpd':
    template: 'ucm/base/system/ntpd.erb'

#  '/etc/motd':
#    template: 'ucm/base/system/motd.erb'
#  '/etc/master.cf':
#    template: 'ucm/base/system/master.cf.erb'
#  '/etc/main.cf':
#    template: 'ucm/base/system/main.cf.erb'
#  '/etc/postfix/relay_password':
#    template: 'ucm/base/system/relaypassword.erb'
    
base::services:
  'ntpd':
    state: 'running'
    subscribe_to: '/etc/ntp.conf'

#  'splunk':
#    state: 'running'
#  'kdump':
#    state: 'running'
#  'postfix':
#    state: 'running'

# PLACE HOLDER FOR MISC COMMANDS 
#base::miscellaneous:
#  'postfix':
#    tag: 'refresh_postmap_on_pw_update'
#    description: "...Runs postmap hash when relay pw file is updated"
#  'splunk':
#    tag: 'accept_license'
#    description: "...Runs splunk license accept after install"

base::kernelparams:
  "net.ipv4.conf.all.accept_source_route":
    value: 0
    comment: TDA Default
  "net.ipv4.conf.default.accept_source_route":
    value: 0
    comment: TDA Default
  "net.ipv4.tcp_syncookies":
    value: 1
    comment: TDA Default
  "net.ipv4.tcp_max_syn_backlog":
    value: 4096
    comment: TDA Default
  "net.ipv4.conf.all.rp_filter":
    value: 1
    comment: TDA Default
  "net.ipv4.conf.default.rp_filter":
    value: 1
    comment: TDA Default
  "net.ipv4.conf.all.send_redirects":
    value: 0
    comment: TDA Default
  "net.ipv4.conf.default.send_redirects":
    value: 0
    comment: TDA Default
  "net.ipv4.conf.all.accept_redirects":
    value: 0
    comment: TDA Default
  "net.ipv4.icmp_echo_ignore_broadcasts":
    value: 1
    comment: TDA Default
  "net.ipv4.conf.all.log_martians":
    value: 0
    comment: TDA Default
  "net.ipv4.tcp_timestamps":
    value: 0
    comment: TDA Default
  "net.ipv4.conf.all.secure_redirects":
    value: 0
    comment: TDA Default
  "net.ipv4.conf.default.secure_redirects":
    value: 0
    comment: TDA Default
  "net.ipv4.conf.default.accept_redirects":
    value: 0
    comment: TDA Default
  "net.ipv4.tcp_keepalive_time":
    value: 900
    comment: TDA Default
  "net.ipv4.tcp_keepalive_probes":
    value: 9
    comment: TDA Default
  "net.ipv4.tcp_keepalive_intvl":
    value: 60
    comment: TDA Default
  "net.ipv4.ip_local_reserved_ports":
    value: 9989
    comment: TDA Default


