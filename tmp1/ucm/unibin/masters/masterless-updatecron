#!/bin/bash

  product="`facter product`"
  child="`facter child`"

  if [[ $product = 'ucm' && $child = 'schedule' ]]
  then is_saltmaster='true'
  else echo "`uname -n` not a UCM Salt Master Server.  Bailing." ; exit 1
  fi

  if [[ $is_saltmaster = 'true' ]]
  then env='production'
       modpath="/etc/puppetlabs/code/environments/${env}/modules/"

       clear
       echo "Running local Puppet class to setup cron jobs based on ucm/data/schedule.yaml"
       echo ""
       puppet apply -t --environment=${env} --modulepath=${modpath} -e 'include ucm::sme::baseline'
       echo ""
       echo ""

       echo "Root's crontab:"
       echo ""
       crontab -l
       echo ""
  fi

