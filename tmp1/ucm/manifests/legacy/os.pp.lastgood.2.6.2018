class ucm::legacy::os {
  tag 'ucm_legacy_os'

  if $::ucmos == undef {
    notify {
      'msg_noos':
        message => '... no operating system fact "ucmos" set.'
    }
  }

  else {
    
    $os              = "${::ucmos}"
    $os_groups       = "${::ucmos}::groups"
    $os_users        = "${::ucmos}::users"
    $os_packages     = "${::ucmos}::packages"
    $os_directories  = "${::ucmos}::directories"
    $os_files        = "${::ucmos}::files"
    $os_links        = "${::ucmos}::links"
    $os_limits       = "${::ucmos}::limits"
    $os_cron         = "${::ucmos}::cron"
    $os_commands     = "${::ucmos}::commands"
    $os_services     = "${::ucmos}::services"
    

    notify {
      'msg_runninglegacyos':
        message => "... ucmos fact = $::ucmos"
    }

    ucm::custom::os::groups {
      "$os":
        lookupitem => "$os_groups",
        # require    => Notify['msg_runninglegacyos']
    }

    ucm::custom::os::users {
      "$os":
        lookupitem => "$os_users",
        # require    => Ucm::Custom::Os::Groups["$os"]
    }

    ucm::custom::os::packages {
      "$os":
        lookupitem => "$os_packages",
        require    => Ucm::Custom::Os::Groups["$os"]
        # require    => Ucm::Custom::Os::Users["$os"]
    }

    ucm::custom::os::directories {
      "$os":
        lookupitem => "$os_directories",
        # require    => Ucm::Custom::Os::Packages["$os"]
    }

    ucm::custom::os::files {
      "$os":
        lookupitem => "$os_files",
        # require    => Ucm::Custom::Os::Directories["$os"]
    }

   ucm::custom::os::links {
     "$os":
       lookupitem => "$os_links",
       # require    => Ucm::Custom::Os::Files["$os"]

   }

    ucm::custom::os::limits {
      "$os":
        lookupitem => "$os_limits",
        # require    => Ucm::Custom::Os::Links["$os"]
    }

    ucm::custom::os::cron {
      "$os":
        lookupitem => "$os_cron",
        # require    => Ucm::Custom::Os::Limits["$os"]
    }

    ucm::custom::os::services {
      "$os":
        lookupitem => "$os_services",
        require    => Ucm::Custom::Os::Files["$os"]
        # require    => Ucm::Custom::Os::Limits["$os"]
    }

    ucm::custom::os::commands {
      "$os":
        lookupitem => "$os_commands",
        require    => Ucm::Custom::Os::Services["$os"]
        # require    => Ucm::Custom::Os::Cron["$os"]
    }
  }
}
